const btContacts=document.querySelectorAll(".btContact[type=button]");btContacts.forEach(e=>e.addEventListener("click",function(){bground.setAttribute("visible","true")}));const btClose=document.querySelector(".close"),bground=document.querySelector(".bground"),btSubmits=document.querySelectorAll("button[type=submit]"),inputsTexts=document.querySelectorAll("input[type=text]"),inputEmail=document.getElementById("email"),formDatas=document.querySelectorAll(".formData"),formModal=document.querySelector(".form-modal"),textArea=document.querySelector("textarea"),form=document.querySelector("form[name=reserve]");console.log(form);const firstLastRegex=/^[^0-9_!¡?÷?¿/\\+=@#$%ˆ&*(){}|~<>;:[\]]{2,}$/,emailRegex=/^(([^<>()[]\.,;:s@]+(.[^<>()[]\.,;:s@]+)*)|(.+))@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}])|(([a-zA-Z-0-9]+.)+[a-zA-Z]{2,}))$/;function submit(t,i){t.forEach(e=>e.addEventListener("click",function(e){e.preventDefault(),verifDataValid(i)&&(createValidText(t,btClose),form.reset(),i.forEach(e=>{e.removeAttribute("data-valid")}),console.log("data valide")),console.log("test")}))}function createValidText(e,t){const i=document.createElement("div");i.id="validDiv",formModal.appendChild(i),i.innerHTML="<p>Merci ! Votre message a bien été envoyé.</p>",t.addEventListener("click",function(){formModal.removeChild(document.getElementById("validDiv"))})}function verifDataValid(e){return!!(e[0]&&e[1]&&e[2]&&e[3]).hasAttribute("data-valid")}function hideError(e){e.removeAttribute("data-error-visible"),e.removeAttribute("data-error"),e.setAttribute("data-valid","true")}function showError(e,t){e.removeAttribute("data-valid"),e.setAttribute("data-error-visible","true"),e.setAttribute("data-error",t)}function verifMessage(i){i.addEventListener("input",function(e){var t=e.target.value.trim(),e=i.parentNode;t.length<8?showError(e,"Veuillez entrer 8 caractéres minimum"):hideError(e)})}function verifEmail(i){i.addEventListener("input",function(e){var t=e.target.value,e=i.parentNode;emailRegex.test(t)?hideError(e):showError(e,"Veuillez entrez une adresse email valide")})}function verifNameAndSurname(e){e.forEach(i=>i.addEventListener("input",function(e){var t=e.target.value.trim(),e=i.parentNode;t.length<2?showError(e,"Veuillez entrer 2 caractéres minimum"):firstLastRegex.test(t)?hideError(e):showError(e,"Veuillez entrez seulement des caractéres litterales")}))}btClose.addEventListener("click",function(){bground.removeAttribute("visible")}),verifNameAndSurname(inputsTexts),verifEmail(inputEmail),verifMessage(textArea),submit(btSubmits,formDatas);const widget=document.getElementById("widget");function deactivateSelect(e){e.classList.contains("active")&&(e.querySelector(".optList").classList.add("hidden"),e.classList.remove("active"))}function activeSelect(e,t){e.classList.contains("active")||t.forEach(deactivateSelect)}function toggleOptList(e){e.querySelector(".optList").classList.toggle("hidden"),e.classList.toggle("active")}function highlightOption(e,t){e.querySelectorAll(".option").forEach(function(e){e.classList.remove("highlight")}),t.classList.add("highlight")}function updateValue(e,t){var i=e.previousElementSibling,r=e.querySelector(".value"),n=e.querySelectorAll(".option");n.forEach(function(e){e.setAttribute("aria-selected","false")}),n[t].setAttribute("aria-selected","true"),i.selectedIndex=t,r.innerHTML=n[t].innerHTML,highlightOption(e,n[t])}function getIndex(e){return e.previousElementSibling.selectedIndex}window.addEventListener("load",function(){widget.classList.remove("no-widget"),widget.classList.add("widget")}),window.addEventListener("load",function(){var e=document.querySelectorAll(".select");e.forEach(function(t){t.querySelectorAll(".option").forEach(function(e){e.addEventListener("mouseover",function(){highlightOption(t,e)})}),t.addEventListener("click",function(){toggleOptList(t)}),t.addEventListener("focus",function(){activeSelect(t,e)}),t.addEventListener("blur",function(){deactivateSelect(t)})})}),window.addEventListener("load",function(){document.querySelectorAll(".select").forEach(function(r){var n=r.querySelectorAll(".option"),e=getIndex(r);r.tabIndex=0,r.previousElementSibling.tabIndex=-1,updateValue(r,e),n.forEach(function(e,t){e.addEventListener("click",function(){updateValue(r,t)})}),r.addEventListener("keyup",function(e){var t=n.length,i=getIndex(r);40===e.keyCode&&i<t-1&&i++,38===e.keyCode&&0<i&&i--,13===e.keyCode&&(r.querySelector(".optList").classList.toggle("hidden"),r.classList.toggle("active")),updateValue(r,i)})})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvYnRDb250YWN0L2J0Q29udGFjdC5qcyIsImNvbXBvbmVudHMvZm9ybS1tb2RhbC9mb3JtLW1vZGFsLmpzIiwiY29tcG9uZW50cy93aWRnZXQvd2lkZ2V0LmpzIl0sIm5hbWVzIjpbImJ0Q29udGFjdHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYnRDb250YWN0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImJncm91bmQiLCJzZXRBdHRyaWJ1dGUiLCJidENsb3NlIiwicXVlcnlTZWxlY3RvciIsImJ0U3VibWl0cyIsImlucHV0c1RleHRzIiwiaW5wdXRFbWFpbCIsImdldEVsZW1lbnRCeUlkIiwiZm9ybURhdGFzIiwiZm9ybU1vZGFsIiwidGV4dEFyZWEiLCJmb3JtIiwiY29uc29sZSIsImxvZyIsImZpcnN0TGFzdFJlZ2V4IiwiZW1haWxSZWdleCIsInN1Ym1pdCIsImJ0U3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwidmVyaWZEYXRhVmFsaWQiLCJjcmVhdGVWYWxpZFRleHQiLCJyZXNldCIsImZvcm1EYXRhIiwicmVtb3ZlQXR0cmlidXRlIiwidmFsaWREaXYiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJhcHBlbmRDaGlsZCIsImlubmVySFRNTCIsInJlbW92ZUNoaWxkIiwiaGFzQXR0cmlidXRlIiwiaGlkZUVycm9yIiwiY2libGUiLCJzaG93RXJyb3IiLCJlcnJvclRleHQiLCJ2ZXJpZk1lc3NhZ2UiLCJsZXQiLCJ0ZXh0QXJlYVZhbHVlIiwidGFyZ2V0IiwidmFsdWUiLCJ0cmltIiwicGFyZW50Tm9kZSIsImxlbmd0aCIsInZlcmlmRW1haWwiLCJ0ZXN0IiwidmVyaWZOYW1lQW5kU3VybmFtZSIsImlucHV0VGV4dCIsInRleHRWYWx1ZSIsIndpZGdldCIsImRlYWN0aXZhdGVTZWxlY3QiLCJzZWxlY3QiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImFkZCIsInJlbW92ZSIsImFjdGl2ZVNlbGVjdCIsInNlbGVjdExpc3QiLCJ0b2dnbGVPcHRMaXN0IiwidG9nZ2xlIiwiaGlnaGxpZ2h0T3B0aW9uIiwib3B0aW9uIiwib3RoZXIiLCJ1cGRhdGVWYWx1ZSIsImluZGV4IiwibmF0aXZlV2lkZ2V0IiwicHJldmlvdXNFbGVtZW50U2libGluZyIsIm9wdGlvbkxpc3QiLCJzZWxlY3RlZEluZGV4IiwiZ2V0SW5kZXgiLCJ3aW5kb3ciLCJ0YWJJbmRleCIsImtleUNvZGUiXSwibWFwcGluZ3MiOiJBQUFBLE1BQUFBLFdBQUFDLFNBQUFDLGlCQUFBLDJCQUtBRixXQUFBRyxRQUFBLEdBQ0FDLEVBQUFDLGlCQUFBLFFBQUEsV0FDQUMsUUFBQUMsYUFBQSxVQUFBLFdDSkEsTUFBQUMsUUFBQVAsU0FBQVEsY0FBQSxVQUlBSCxRQUFBTCxTQUFBUSxjQUFBLFlBSUFDLFVBQUFULFNBQUFDLGlCQUFBLHVCQUlBUyxZQUFBVixTQUFBQyxpQkFBQSxvQkFJQVUsV0FBQVgsU0FBQVksZUFBQSxTQUlBQyxVQUFBYixTQUFBQyxpQkFBQSxhQUNBYSxVQUFBZCxTQUFBUSxjQUFBLGVBQ0FPLFNBQUFmLFNBQUFRLGNBQUEsWUFDQVEsS0FBQWhCLFNBQUFRLGNBQUEsc0JBQ0FTLFFBQUFDLElBQUFGLE1BS0EsTUFBQUcsZUFBQSwrQ0FJQUMsV0FDQSxzSUFZQSxTQUFBQyxPQUFBWixFQUFBSSxHQUNBSixFQUFBUCxRQUFBLEdBQ0FvQixFQUFBbEIsaUJBQUEsUUFBQSxTQUFBbUIsR0FDQUEsRUFBQUMsaUJBQ0FDLGVBQUFaLEtBQ0FhLGdCQUFBakIsRUFBQUYsU0FDQVMsS0FBQVcsUUFDQWQsRUFBQVgsUUFBQSxJQUNBMEIsRUFBQUMsZ0JBQUEsZ0JBRUFaLFFBQUFDLElBQUEsZ0JBS0FELFFBQUFDLElBQUEsV0FTQSxTQUFBUSxnQkFBQWpCLEVBQUFGLEdBQ0EsTUFBQXVCLEVBQUE5QixTQUFBK0IsY0FBQSxPQUNBRCxFQUFBRSxHQUFBLFdBQ0FsQixVQUFBbUIsWUFBQUgsR0FDQUEsRUFBQUksVUFBQSxrREFDQTNCLEVBQUFI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aUJBQUEsWUFBQSxXQUdBNkQsZ0JBQUFULEVBQUFVLE9BSUFWLEVBQUFwRCxpQkFBQSxRQUFBLFdBSUEyRCxjQUFBUCxLQUtBQSxFQUFBcEQsaUJBQUEsUUFBQSxXQUlBeUQsYUFBQUwsRUFBQU0sS0FHQU4sRUFBQXBELGlCQUFBLE9BQUEsV0FJQW1ELGlCQUFBQyxTQTBDQW1CLE9BQUF2RSxpQkFBQSxPQUFBLFdBQ0FKLFNBQUFDLGlCQUFBLFdBRUFDLFFBQUEsU0FBQXNELEdBQ0EsSUFBQWdCLEVBQUFoQixFQUFBdkQsaUJBQUEsV0FDQXdFLEVBQUFDLFNBQUFsQixHQUVBQSxFQUFBb0IsU0FBQSxFQUVBcEIsRUFBQWUsdUJBQUFLLFVBQUEsRUFFQVIsWUFBQVosRUFBQWlCLEdBR0FELEVBQUF0RSxRQUFBLFNBQUFnRSxFQUFBRyxHQUNBSCxFQUFBOUQsaUJBQUEsUUFBQSxXQUNBZ0UsWUFBQVosRUFBQWEsT0FLQWIsRUFBQXBELGlCQUFBLFFBQUEsU0FBQW1CLEdBQ0EsSUFBQXlCLEVBQUF3QixFQUFBeEIsT0FDQXFCLEVBQUFLLFNBQUFsQixHQUVBLEtBQUFqQyxFQUFBc0QsU0FBQVIsRUFBQXJCLEVBQUEsR0FDQXFCLElBR0EsS0FBQTlDLEVBQUFzRCxTQUFBLEVBQUFSLEdBQ0FBLElBR0EsS0FBQTlDLEVBQUFzRCxVQUNBckIsRUFBQWhELGNBQUEsWUFFQWlELFVBQUFPLE9BQUEsVUFDQVIsRUFBQUMsVUFBQU8sT0FBQSxXQUVBSSxZQUFBWixFQUFBYSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBidENvbnRhY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5idENvbnRhY3RbdHlwZT1idXR0b25dXCIpO1xuXG4vKipcbiAqIEF1IGNsaWMgc3VyIHVuIGRlcyBib3V0b25zIFwiQ29udGFjdGV6IG1vaVwiID0+IE91dmVydHVyZSBkZSBsYSBmb3JtLW1vZGFsXG4gKi9cbmJ0Q29udGFjdHMuZm9yRWFjaCgoYnRDb250YWN0KSA9PlxuXHRidENvbnRhY3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRiZ3JvdW5kLnNldEF0dHJpYnV0ZShcInZpc2libGVcIiwgXCJ0cnVlXCIpO1xuXHR9KVxuKTtcbiIsIi8qKlxuICogQm91dG9uIGNyb2l4IGZlcm1ldHVyZSBmb3JtLW1vZGFsXG4gKi9cbmNvbnN0IGJ0Q2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNsb3NlXCIpO1xuLyoqXG4gKiBCYWNrZ3JvdW5kIGRlIGZvcm0tbW9kYWxcbiAqL1xuY29uc3QgYmdyb3VuZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYmdyb3VuZFwiKTtcbi8qKlxuICogQm91dG9ucyBzdWJtaXQgZGUgZm9ybS1tb2RhbFxuICovXG5jb25zdCBidFN1Ym1pdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiYnV0dG9uW3R5cGU9c3VibWl0XVwiKTtcbi8qKlxuICogSW5wdXRzIGRlIFt0eXBlPXRleHRdXG4gKi9cbmNvbnN0IGlucHV0c1RleHRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImlucHV0W3R5cGU9dGV4dF1cIik7XG4vKipcbiAqIElucHV0IEVtYWlsXG4gKi9cbmNvbnN0IGlucHV0RW1haWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVtYWlsXCIpO1xuLyoqXG4gKiBUYWJsZWF1IGZvcm1EYXRhc1xuICovXG5jb25zdCBmb3JtRGF0YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1EYXRhXCIpO1xuY29uc3QgZm9ybU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtLW1vZGFsXCIpO1xuY29uc3QgdGV4dEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwidGV4dGFyZWFcIik7XG5jb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1bbmFtZT1yZXNlcnZlXVwiKTtcbmNvbnNvbGUubG9nKGZvcm0pO1xuLyogKioqKioqKioqKioqKiBSRUdFWCAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXG4vKipcbiAqIFJlZ2V4ICg8IDIgY2hhcmFjdGVyczsgUGFzIGRlIGNoaWZmcmVzKVxuICovXG5jb25zdCBmaXJzdExhc3RSZWdleCA9IC9eW14wLTlfIcKhP8O3P8K/L1xcXFwrPUAjJCXLhiYqKCl7fXx+PD47OltcXF1dezIsfSQvO1xuLyoqXG4gKiBSZWdleCBkZSB2w6lyaWZpY2F0aW9uIGQnZW1haWxcbiAqL1xuY29uc3QgZW1haWxSZWdleCA9XG5cdC9eKChbXjw+KClbXVxcLiw7OnNAXSsoLltePD4oKVtdXFwuLDs6c0BdKykqKXwoLispKUAoKFtbMC05XXsxLDN9LlswLTldezEsM30uWzAtOV17MSwzfS5bMC05XXsxLDN9XSl8KChbYS16QS1aLTAtOV0rLikrW2EtekEtWl17Mix9KSkkLzsgLy8gVsOpcmlmaWNhdGlvbiBkJ2VtYWlsXG5cbi8qKlxuICogVsOpcmlmaWUgc2kgdG91dGVzIGxlcyBkb25uw6llcyBlbnRyw6llcyBwYXIgbCd1dGlsaXNhdGV1ciBzb250IHZhbGlkZS5cbiAqIFNpIGxlcyBkb25uw6llcyBzb250IHZhbGlkw6llcyBvbiBsZXMgYWZmaWNoZSBkYW5zIGxhIGNvbnNvbGVcbiAqIGV0IGxlIG1lc3NhZ2UgZGUgdmFsaWRhdGlvbiBhcHBhcmFpdC5cbiAqXG4gKiBAcGFyYW0gICB7YW55fSAgYnRTdWJtaXRzICBbYnRTdWJtaXRzIGRlc2NyaXB0aW9uXVxuICogQHBhcmFtICAge2FueX0gIGZvcm1EYXRhcyAgW2Zvcm1EYXRhcyBkZXNjcmlwdGlvbl1cbiAqXG4gKiBAcmV0dXJuICB7dm9pZH0gICAgICAgICAgICAgQWZmaWNoZSBsZXMgZG9ubsOpZXMgZXQgbGUgbWVzc2FnZSBkZSB2YWxpZGF0aW9uIHNpIGxlcyBkb25uw6llcyBzb250IHZhbGlkw6llcy5cbiAqL1xuZnVuY3Rpb24gc3VibWl0KGJ0U3VibWl0cywgZm9ybURhdGFzKSB7XG5cdGJ0U3VibWl0cy5mb3JFYWNoKChidFN1Ym1pdCkgPT5cblx0XHRidFN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGlmICh2ZXJpZkRhdGFWYWxpZChmb3JtRGF0YXMpKSB7XG5cdFx0XHRcdGNyZWF0ZVZhbGlkVGV4dChidFN1Ym1pdHMsIGJ0Q2xvc2UpO1xuXHRcdFx0XHRmb3JtLnJlc2V0KCk7XG5cdFx0XHRcdGZvcm1EYXRhcy5mb3JFYWNoKChmb3JtRGF0YSkgPT4ge1xuXHRcdFx0XHRcdGZvcm1EYXRhLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtdmFsaWRcIik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcImRhdGEgdmFsaWRlXCIpO1xuXHRcdFx0XHQvLyBpZiBvayA9PiBsb2cgKyBhZmZpY2hlIHZhbGlkIG1lc3NhZ2Vcblx0XHRcdH1cblxuXHRcdFx0Ly8gZWxzZSA9PiBtc2cgZXJyb3Jcblx0XHRcdGNvbnNvbGUubG9nKFwidGVzdFwiKTtcblx0XHR9KVxuXHQpO1xufVxuXG4vKipcbiAqIEFmZmljaGUgbGUgbWVzc2FnZSBkZSB2YWxpZGF0aW9uXG4gKiBAcmV0dXJuICB7dm9pZH0gIEFmZmljaGUgbGUgbWVzc2FnZSBkZSB2YWxpZGF0aW9uIC8gQ2hhbmdlIGxlcyBhdHRyaWJ1dHMgZGVzIGJvdXRvbnMgZGUgbGEgbW9kYWxcbiAqL1xuZnVuY3Rpb24gY3JlYXRlVmFsaWRUZXh0KGJ0U3VibWl0cywgYnRDbG9zZSkge1xuXHRjb25zdCB2YWxpZERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdHZhbGlkRGl2LmlkID0gXCJ2YWxpZERpdlwiO1xuXHRmb3JtTW9kYWwuYXBwZW5kQ2hpbGQodmFsaWREaXYpO1xuXHR2YWxpZERpdi5pbm5lckhUTUwgPSBcIjxwPk1lcmNpICEgVm90cmUgbWVzc2FnZSBhIGJpZW4gw6l0w6kgZW52b3nDqS48L3A+XCI7XG5cdGJ0Q2xvc2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRmb3JtTW9kYWwucmVtb3ZlQ2hpbGQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2YWxpZERpdlwiKSk7XG5cdH0pO1xuXHQvLyBidFN1Ym1pdHMuZm9yRWFjaCgoYnRTdWJtaXQpID0+IHtcblx0Ly8gXHQvLyBidFN1Ym1pdC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiYnV0dG9uXCIpO1xuXHQvLyBcdC8vIGJ0U3VibWl0LnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIFwiRmVybWVyXCIpO1xuXHQvLyBcdC8vIGJ0U3VibWl0LnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJidXR0b25cIik7XG5cdC8vIFx0Ly8gYnRDbG9zZS5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwiYnV0dG9uXCIpO1xuXHQvLyB9KTtcbn1cblxuLyoqXG4gKiBWZXJpZmljYXRpb24gcXVlIHRvdXMgbGVzIGVsZW1lbnRzIGR1IHRhYmxlYXUgZm9ybURhdGFzIG9udCBsJ2F0dHJpYnV0IFwiZGF0YS12YWxpZFwiXG4gKlxuICogQHBhcmFtICAge0FycmF5fSAgZm9ybURhdGFzICBUYWJsZWF1IGZvcm1EYXRhc1xuICpcbiAqIEByZXR1cm4gIHtCb29sZWFufSAgICAgICAgICAgICBUb3VzIGxlcyBlbGVtZW50cyBvbnQgbCdhdHRyaWJ1dCBcImRhdGEtdmFsaWRcIiA9PiB0cnVlO1xuICovXG5mdW5jdGlvbiB2ZXJpZkRhdGFWYWxpZChmb3JtRGF0YXMpIHtcblx0aWYgKFxuXHRcdChmb3JtRGF0YXNbMF0gJiYgZm9ybURhdGFzWzFdICYmIGZvcm1EYXRhc1syXSAmJiBmb3JtRGF0YXNbM10pLmhhc0F0dHJpYnV0ZShcblx0XHRcdFwiZGF0YS12YWxpZFwiXG5cdFx0KVxuXHQpIHtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn1cblxuZnVuY3Rpb24gaGlkZUVycm9yKGNpYmxlKSB7XG5cdGNpYmxlLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtZXJyb3ItdmlzaWJsZVwiKTtcblx0Y2libGUucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1lcnJvclwiKTtcblx0Y2libGUuc2V0QXR0cmlidXRlKFwiZGF0YS12YWxpZFwiLCBcInRydWVcIik7XG59XG5mdW5jdGlvbiBzaG93RXJyb3IoY2libGUsIGVycm9yVGV4dCkge1xuXHRjaWJsZS5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXZhbGlkXCIpO1xuXHRjaWJsZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLWVycm9yLXZpc2libGVcIiwgXCJ0cnVlXCIpO1xuXHRjaWJsZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLWVycm9yXCIsIGVycm9yVGV4dCk7XG59XG5cbmZ1bmN0aW9uIHZlcmlmTWVzc2FnZSh0ZXh0QXJlYSkge1xuXHR0ZXh0QXJlYS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRsZXQgdGV4dEFyZWFWYWx1ZSA9IGUudGFyZ2V0LnZhbHVlLnRyaW0oKTtcblx0XHRsZXQgY2libGUgPSB0ZXh0QXJlYS5wYXJlbnROb2RlO1xuXHRcdGlmICh0ZXh0QXJlYVZhbHVlLmxlbmd0aCA8IDgpIHtcblx0XHRcdHNob3dFcnJvcihjaWJsZSwgXCJWZXVpbGxleiBlbnRyZXIgOCBjYXJhY3TDqXJlcyBtaW5pbXVtXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRoaWRlRXJyb3IoY2libGUpO1xuXHRcdH1cblx0fSk7XG59XG5cbi8qKlxuICogVsOpcmlmaWNhdGlvbiBkZSBsYSB2YWxldXIgZW50csOpZSBwYXIgbCd1dGlsaXNhdGV1ciBwb3VyIGwnRW1haWxcbiAqXG4gKiBAcGFyYW0gICB7YW55fSAgaW5wdXRFbWFpbCAgSW5wdXQgRW1haWxcbiAqXG4gKiBAcmV0dXJuICB7dm9pZH0gICAgICAgICAgICAgIEFmZmljaGUgbGUgbWVzc2FnZSBkJ2VycmV1ciBzaSBsJ0VtYWlsIG4nZXN0IHBhcyB2YWxpZGVcbiAqL1xuZnVuY3Rpb24gdmVyaWZFbWFpbChpbnB1dEVtYWlsKSB7XG5cdGlucHV0RW1haWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0bGV0IHZhbHVlID0gZS50YXJnZXQudmFsdWU7XG5cdFx0bGV0IGNpYmxlID0gaW5wdXRFbWFpbC5wYXJlbnROb2RlO1xuXHRcdGlmICghZW1haWxSZWdleC50ZXN0KHZhbHVlKSkge1xuXHRcdFx0c2hvd0Vycm9yKGNpYmxlLCBcIlZldWlsbGV6IGVudHJleiB1bmUgYWRyZXNzZSBlbWFpbCB2YWxpZGVcIik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGhpZGVFcnJvcihjaWJsZSk7XG5cdFx0fVxuXHR9KTtcbn1cblxuLyoqXG4gKiBWw6lyaWZpY2F0aW9uIGRlcyB2YWxldXJzIGVudHLDqWVzIHBhciBsJ3V0aWxpc2F0ZXVyIHBvdXIgbGUgTm9tIGV0IGxlIFByw6lub21cbiAqXG4gKiBAcGFyYW0gICB7YW55fSAgaW5wdXRzVGV4dHMgIElucHV0cyBkZSBbdHlwZT10ZXh0XVxuICpcbiAqIEByZXR1cm4gIHt2b2lkfSAgICAgICAgICAgICAgQWZmaWNoZSBsZSBtZXNzYWdlIGQnZXJyZXVyIHNpIGwnZW50csOpZSBuJ2VzdCBwYXMgdmFsaWRlXG4gKi9cbmZ1bmN0aW9uIHZlcmlmTmFtZUFuZFN1cm5hbWUoaW5wdXRzVGV4dHMpIHtcblx0aW5wdXRzVGV4dHMuZm9yRWFjaCgoaW5wdXRUZXh0KSA9PlxuXHRcdGlucHV0VGV4dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGxldCB0ZXh0VmFsdWUgPSBlLnRhcmdldC52YWx1ZS50cmltKCk7XG5cdFx0XHRsZXQgY2libGUgPSBpbnB1dFRleHQucGFyZW50Tm9kZTtcblx0XHRcdGlmICh0ZXh0VmFsdWUubGVuZ3RoIDwgMikge1xuXHRcdFx0XHRzaG93RXJyb3IoY2libGUsIFwiVmV1aWxsZXogZW50cmVyIDIgY2FyYWN0w6lyZXMgbWluaW11bVwiKTtcblx0XHRcdH0gZWxzZSBpZiAoIWZpcnN0TGFzdFJlZ2V4LnRlc3QodGV4dFZhbHVlKSkge1xuXHRcdFx0XHRzaG93RXJyb3IoY2libGUsIFwiVmV1aWxsZXogZW50cmV6IHNldWxlbWVudCBkZXMgY2FyYWN0w6lyZXMgbGl0dGVyYWxlc1wiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGhpZGVFcnJvcihjaWJsZSk7XG5cdFx0XHR9XG5cdFx0fSlcblx0KTtcbn1cblxuLyoqXG4gKiBBdSBjbGljIHN1ciBsYSBjcm9peCA9PiBGZXJtZXR1cmUgZGUgZm9ybS1tb2RhbFxuICovXG5idENsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG5cdGJncm91bmQucmVtb3ZlQXR0cmlidXRlKFwidmlzaWJsZVwiKTtcbn0pO1xuXG52ZXJpZk5hbWVBbmRTdXJuYW1lKGlucHV0c1RleHRzKTtcbnZlcmlmRW1haWwoaW5wdXRFbWFpbCk7XG52ZXJpZk1lc3NhZ2UodGV4dEFyZWEpO1xuc3VibWl0KGJ0U3VibWl0cywgZm9ybURhdGFzKTtcbiIsImNvbnN0IHdpZGdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lkZ2V0XCIpO1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xuXHR3aWRnZXQuY2xhc3NMaXN0LnJlbW92ZShcIm5vLXdpZGdldFwiKTtcblx0d2lkZ2V0LmNsYXNzTGlzdC5hZGQoXCJ3aWRnZXRcIik7XG59KTtcblxuLy8gQ2V0dGUgZm9uY3Rpb24gZXN0IHV0aWxpc8OpZSBjaGFxdWUgZm9pcyBxdWUgbm91cyB2b3Vsb25zIGTDqXNhY3RpdmVyIHVuXG4vLyB3aWRnZXQgcGVyc29ubmFsaXPDqS4gRWxsZSBwcmVuZCB1biBwYXJhbcOodHJlXG4vLyBzZWxlY3QgOiBsZSBuxZN1ZCBET00gYXZlYyBsYSBjbGFzc2Ugc2VsZWN0IMOgIGTDqXNhY3RpdmVyXG5mdW5jdGlvbiBkZWFjdGl2YXRlU2VsZWN0KHNlbGVjdCkge1xuXHQvLyBTaSBsZSB3aWRnZXQgbidlc3QgcGFzIGFjdGlmLCBpbCBuJ3kgYSByaWVuIMOgIGZhaXJlXG5cdGlmICghc2VsZWN0LmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSkgcmV0dXJuO1xuXHQvLyBOb3VzIGRldm9ucyBvYnRlbmlyIGxhIGxpc3RlIGRlcyBvcHRpb25zIHBvdXIgbGUgd2lkZ2V0IHBlcnNvbm5hbGlzw6lcblx0dmFyIG9wdExpc3QgPSBzZWxlY3QucXVlcnlTZWxlY3RvcihcIi5vcHRMaXN0XCIpO1xuXHQvLyBOb3VzIGNhY2hvbnMgbGEgbGlzdGUgZGVzIG9wdGlvbnNcblx0b3B0TGlzdC5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuXHQvLyBldCBub3VzIGTDqXNhY3Rpdm9ucyBsZSB3aWRnZXQgcGVyc29ubmFsaXPDqSBsdWktbcOqbWVcblx0c2VsZWN0LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG59XG5cbi8vIENldHRlIGZvbmN0aW9uIHNlcmEgdXRpbGlzw6llIGNoYXF1ZSBmb2lzIHF1ZSBsJ3V0aWxpc2F0ZXVyIHZldXQgKGRlcylhY3RpdmVyIGxlIHdpZGdldFxuLy8gRWxsZSBwcmVuZCBkZXV4IHBhcmFtw6h0cmVzIDpcbi8vIHNlbGVjdCA6IGxlIG7Fk3VkIERPTSBkZSBsYSBjbGFzc2UgYHNlbGVjdGAgw6AgYWN0aXZlclxuLy8gc2VsZWN0TGlzdCA6IGxhIGxpc3RlIGRlIHRvdXMgbGVzIG7Fk3VkcyBET00gZGUgbGEgY2xhc3NlIGBzZWxlY3RgXG5mdW5jdGlvbiBhY3RpdmVTZWxlY3Qoc2VsZWN0LCBzZWxlY3RMaXN0KSB7XG5cdC8vIFNpIGxlIHdpZGdldCBlc3QgZMOpasOgIGFjdGlmIGlsIG4neSBhIHJpZW4gw6AgZmFpcmVcblx0aWYgKHNlbGVjdC5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikpIHJldHVybjtcblx0Ly8gTm91cyBkZXZvbnMgZMOpc2FjdGl2ZXIgdG91cyBsZXMgd2lkZ2V0cyBwZXJzb25uYWxpc8Opc1xuXHQvLyBjb21tZSBsYSBmb25jdGlvbiBkZWFjdGl2YXRlU2VsZWN0IHJlbXBsaXQgdG91dGVzIGxlcyBmb25jdGlvbm5hbGl0w6lzIGRlIGxhXG5cdC8vIGZvbmN0aW9uIGRlIHJhcHBlbCBmb3JFYWNoLCBub3VzIGwndXRpbGlzb25zIGRpcmVjdGVtZW50IHNhbnMgdXRpbGlzZXJcblx0Ly8gdW5lIGZvbmN0aW9uIGFub255bWUgaW50ZXJtw6lkaWFpcmUuXG5cdHNlbGVjdExpc3QuZm9yRWFjaChkZWFjdGl2YXRlU2VsZWN0KTtcblx0Ly8gRXQgbm91cyBhY3Rpdm9ucyBsJ8OpdGF0IGR1IHdpZGdldCBkb25uw6lcblx0Ly8gc2VsZWN0LmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG59XG5cbi8vIENldHRlIGZvbmN0aW9uIHNlcmEgdXRpbGlzw6llIGNoYXF1ZSBmb2lzIHF1ZSBsJ3V0aWxpc2F0ZXVyIHZldXQgZW5yb3VsZXIvZMOpcm91bGVyIGxhXG4vLyBsaXN0ZSBkZXMgb3B0aW9uc1xuLy8gRWxsZSBwcmVuZCB1biBwYXJhbcOodHJlIDpcbi8vIHNlbGVjdCA6IGxlIG7Fk3VkIERPTSBkZSBsYSBsaXN0ZSDDoCBiYXNjdWxlclxuZnVuY3Rpb24gdG9nZ2xlT3B0TGlzdChzZWxlY3QpIHtcblx0Ly8gTGEgbGlzdGUgZXN0IHByaXNlIMOgIHBhcnRpciBkdSB3aWRnZXRcblx0dmFyIG9wdExpc3QgPSBzZWxlY3QucXVlcnlTZWxlY3RvcihcIi5vcHRMaXN0XCIpO1xuXHQvLyBOb3VzIGNoYW5nZW9ucyBsYSBjbGFzc2UgZGUgbGEgbGlzdGUgcG91ciBsJ2Vucm91bGVyL2TDqXJvdWxlclxuXHRvcHRMaXN0LmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIik7XG5cdHNlbGVjdC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIpO1xufVxuXG4vLyBDZXR0IGZvbmN0aW9uIHNlcmEgdXRpbGlzw6llIGNoYXF1ZSBmb2lzIHF1J2lsIGZhdXQgbWV0dHJlIGVuIHN1cmJyaWxsYW5jZVxuLy8gdW5lIG9wdGlvbi4gIEVsbGUgcHJlbmQgZGV1eCBwYXJhbcOodHJlcyA6XG4vLyBzZWxlY3QgOiBsZSBuxZN1ZCBET00gZGUgbGEgY2xhc3NlIGBzZWxlY3RgXG4vLyAgICAgICAgICBjb250ZW5hbnQgbCdvcHRpb24gw6AgbWV0dHJlIGVuIHN1cmJyaWxsYW5jZVxuLy8gb3B0aW9uIDogbGUgbsWTdWQgRE9NIGRlIGxhIGNsYXNzZSBgb3B0aW9uYCDDoCBtZXR0cmUgZW4gc3VyYnJpbGxhbmNlXG5mdW5jdGlvbiBoaWdobGlnaHRPcHRpb24oc2VsZWN0LCBvcHRpb24pIHtcblx0Ly8gT2J0ZW5pciBsYSBsaXN0ZSBkZSB0b3V0ZXMgbGVzIG9wdGlvbnMgZGlzcG9uaWJsZXMgcG91ciBsJ8OpbMOpbcOpbnQgc8OpbGVjdGlvbm7DqVxuXHR2YXIgb3B0aW9uTGlzdCA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKFwiLm9wdGlvblwiKTtcblx0Ly8gU3VwcHJpbWVyIGxhIHN1cmJyaWxsYW5jZSBwb3VyIHRvdXRlcyBsZXMgb3B0aW9uc1xuXHRvcHRpb25MaXN0LmZvckVhY2goZnVuY3Rpb24gKG90aGVyKSB7XG5cdFx0b3RoZXIuY2xhc3NMaXN0LnJlbW92ZShcImhpZ2hsaWdodFwiKTtcblx0fSk7XG5cdC8vIE1ldHRyZSBlbiBzdXJicmlsbGFuY2UgbCdvcHRpb24gY29ycmVjdGVcblx0b3B0aW9uLmNsYXNzTGlzdC5hZGQoXCJoaWdobGlnaHRcIik7XG59XG5cbi8vIE5vdXMgbGlvbnMgbGUgd2lkZ2V0IGF1eCDDqXbDqW5lbWVudHMgZMOocyBsZSBjaGFyZ2VtZW50IGR1IGRvY3VtZW50XG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xuXHR2YXIgc2VsZWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2VsZWN0XCIpO1xuXHQvLyBDaGFxdWUgd2lkZ2V0IHBlcnNvbm5hbGlzw6kgZG9pdCDDqnRyZSBpbml0aWFsaXPDqVxuXHRzZWxlY3RMaXN0LmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdCkge1xuXHRcdC8vIGRlIG3Dqm1lIHF1ZSB0b3VzIGxlcyDDqWzDqW1lbnRzIGBvcHRpb25gXG5cdFx0dmFyIG9wdGlvbkxpc3QgPSBzZWxlY3QucXVlcnlTZWxlY3RvckFsbChcIi5vcHRpb25cIik7XG5cdFx0Ly8gQ2hhcXVlIGZvaXMgcXVlIGwndXRpbGlzYXRldXIgcGFzc2UgbGUgcG9pbnRldXIgZGUgc291cmlzXG5cdFx0Ly8gc3VyIHVuZSBvcHRpb24sIG5vdXMgbWV0dG9ucyBlbiBzdXJicmlsbGFuY2UgbGEgZGl0ZSBvcHRpb25cblx0XHRvcHRpb25MaXN0LmZvckVhY2goZnVuY3Rpb24gKG9wdGlvbikge1xuXHRcdFx0b3B0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHQvLyBOb3RlIDogbGVzIHZhcmlhYmxlcyBgc2VsZWN0YCBldCBgb3B0aW9uYCBzb250IGRlcyBcImNsb3N1cmVzXCJcblx0XHRcdFx0Ly8gZGlzcG9uaWJsZXMgZGFucyBsYSBwb3J0w6llIGRlIG5vdHJlIGFwcGVsIGRlIGZvbmN0aW9uLlxuXHRcdFx0XHRoaWdobGlnaHRPcHRpb24oc2VsZWN0LCBvcHRpb24pO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdFx0Ly8gQ2hhcXVlIGZvaXMgcXVlIGwndXRpbGlzYXRldXIgY2xpcXVlIHN1ciB1biDDqWzDqW1lbnQgcGVyc29ubmFsaXPDqVxuXHRcdHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly8gTm90ZSA6IGxhIHZhcmlhYmxlIGBzZWxlY3RgIGVzdCB1bmUgXCJjbG9zdXJlXCJcblx0XHRcdC8vIGF2YWlsYWJsZSBkYW5zIGxhIHBvcnTDqWUgZGUgbm90cmUgYXBwZWwgZGUgZm9uY3Rpb24uXG5cdFx0XHQvLyBOb3VzIGJhc2N1bG9ucyBsYSB2aXNpYmlsaXTDqSBkZSBsYSBsaXN0ZSBkZXMgb3B0aW9uc1xuXHRcdFx0dG9nZ2xlT3B0TGlzdChzZWxlY3QpO1xuXHRcdH0pO1xuXHRcdC8vIERhbnMgbGUgY2FzIG/DuSBsZSB3aWRnZXQgb2J0aWVudCBsZSBmb2N1c1xuXHRcdC8vIExlIHdpZGdldCBvYnRpZW50IGxlIGZvY3VzIGNoYXF1ZSBmb2lzIHF1ZSBsJ3V0aWxpc2F0ZXVyIGNsaXF1ZSBkZXNzdXNcblx0XHQvLyBvdSBwcmVzc2UgbGEgdG91Y2hlIFRhYiBwb3VyIGF2b2lyIGFjY8OocyBhdSB3aWRnZXRcblx0XHRzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRcdC8vIE5vdGUgOiBsZXMgdmFyaWFibGUgYHNlbGVjdGAgZXQgYHNlbGVjdExpc3RgIHNvbnQgZGVzIFwiY2xvc3VyZXNcIlxuXHRcdFx0Ly8gZGlzcG9uaWJsZXMgZGFucyBsYSBwb3J0w6llIGRlIG5vdHJlIGFwcGVsIGRlIGZvbmN0aW9uLlxuXHRcdFx0Ly8gTm91cyBhY3Rpdm9ucyBsZSB3aWRnZXRcblx0XHRcdGFjdGl2ZVNlbGVjdChzZWxlY3QsIHNlbGVjdExpc3QpO1xuXHRcdH0pO1xuXHRcdC8vIERhbnMgbGUgY2FzIG/DuSBsZSB3aWRnZXQgcGVyZCBsZSBmb2N1c1xuXHRcdHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHQvLyBOb3RlIDogbGEgdmFyaWFibGUgYHNlbGVjdGAgZXN0IHVuZSBcImNsb3N1cmVcIlxuXHRcdFx0Ly8gZGlzcG9uaWJsZSBkYW5zIGxhIHBvcnTDqWUgZGUgbm90cmUgYXBwZWwgZGUgZm9uY3Rpb24uXG5cdFx0XHQvLyBOb3VzIGTDqXNhY3Rpdm9ucyBsZSB3aWRnZXRcblx0XHRcdGRlYWN0aXZhdGVTZWxlY3Qoc2VsZWN0KTtcblx0XHR9KTtcblx0fSk7XG59KTtcbi8vIENldHRlIGZvbmN0aW9uIG1ldCDDoCBqb3VyIGxhIHZhbGV1ciBhZmZpY2jDqWUgZXQgbGEgc3luY2hyb25pc2UgYXZlYyBjZWxsZVxuLy8gZHUgd2lkZ2V0IG5hdGlmLiBFbGxlIHByZW5kIGRldXggcGFyYW3DqHRyZXMgOlxuLy8gc2VsZWN0IDogbGUgbsWTdWQgRE9NIGRlIGxhIGNsYXNzZSBgc2VsZWN0YCBjb250ZW5hbnQgbGEgdmFsdWVyIMOgIG1ldHRyZSDDoCBqb3VyXG4vLyBpbmRleCAgOiBsJ2luZGV4IGRlIGxhIHZhbGV1ciBjaG9pc2llXG5mdW5jdGlvbiB1cGRhdGVWYWx1ZShzZWxlY3QsIGluZGV4KSB7XG5cdC8vIE5vdXMgZGV2b25zIG9idGVuaXIgbGUgd2lkZ2V0IG5hdGlmIGNvcnJlc3BvbmRhbnQgYXUgd2lkZ2V0IHBlcnNvbm5hbGlzw6lcblx0Ly8gRGFucyBub3RyZSBleGVtcGxlLCBsZSB3aWRnZXQgbmF0aWYgZXN0IHVuIHBhcmVudCBkdSB3aWRnZXQgcGVyc29ubmFsaXPDqVxuXHR2YXIgbmF0aXZlV2lkZ2V0ID0gc2VsZWN0LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG5cdC8vIE5vdSBkZXZvbnMgYXVzc2kgb2J0ZW5pciBsYSB2YWxldXIgZGUgcmVtcGxhY2VtZW50IGR1IHdpZGdldCBwZXJzb25uYWxpc8OpXG5cdHZhciB2YWx1ZSA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKFwiLnZhbHVlXCIpO1xuXHQvLyBFdCBub3VzIGF2b25zIGJlc29pbiBkZSB0b3V0ZSBsYSBsaXN0ZSBkZXMgb3B0aW9uc1xuXHR2YXIgb3B0aW9uTGlzdCA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKFwiLm9wdGlvblwiKTtcblx0Ly8gTm91cyBub3VzIGFzc3Vyb25zIHF1J2F1Y3VuZSBvcHRpb24gbidlc3Qgc8OpbGVjdGlvbm7DqWVcblx0b3B0aW9uTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChvdGhlcikge1xuXHRcdG90aGVyLnNldEF0dHJpYnV0ZShcImFyaWEtc2VsZWN0ZWRcIiwgXCJmYWxzZVwiKTtcblx0fSk7XG5cdC8vIE5vdXMgbm91cyBhc3N1cm9ucyBxdWUgbCdvcHRpb24gY2hvaXNpZSBlc3Qgc8OpbGVjdGlvbm7DqWVcblx0b3B0aW9uTGlzdFtpbmRleF0uc2V0QXR0cmlidXRlKFwiYXJpYS1zZWxlY3RlZFwiLCBcInRydWVcIik7XG5cdC8vIE5vdXMgZMOpZmluaXNzb25zIGwnaW5kZXggY2hvaXNpIMOgIGwnaW5kZXggZHUgY2hvaXhcblx0bmF0aXZlV2lkZ2V0LnNlbGVjdGVkSW5kZXggPSBpbmRleDtcblx0Ly8gTm91cyBtZXR0b25zIMOgIGpvdXIgbGEgdmFsZXVyIGRlIHJlbXBsYWNlbWVudCBlbiBhY2NvcmRcblx0dmFsdWUuaW5uZXJIVE1MID0gb3B0aW9uTGlzdFtpbmRleF0uaW5uZXJIVE1MO1xuXHQvLyBFdCBub3VzIG1ldHRvbnMgZW4gc3VyYnJpbGxhbmNlIGwnb3B0aW9uIGNvcnJlc3BvbmRhbnRlIGR1IHdpZGdldCBwZXJzb25uYWxpc8OpXG5cdGhpZ2hsaWdodE9wdGlvbihzZWxlY3QsIG9wdGlvbkxpc3RbaW5kZXhdKTtcbn1cblxuLy8gQ2V0dGUgZm9uY3Rpb24gcmVudm9pZSBsJ2luZGV4IGNvdXJhbnQgZGFucyBsZSB3aWRnZXQgbmF0aWZcbi8vIEVsbGUgcHJlbmQgdW4gcGFyYW3DqHRyZSA6XG4vLyBzZWxlY3QgOiBsZSBuxZN1ZCBET00gYXZlYyBsYSBjbGFzc2UgYHNlbGVjdGAgcmVsYXRpdmUgYXUgd2lkZ2V0IG5hdGlmXG5mdW5jdGlvbiBnZXRJbmRleChzZWxlY3QpIHtcblx0Ly8gTm91cyBhdm9ucyBiZXNvaW4gZCdhdm9pciBhY2PDqHMgYXUgd2lkZ2V0IG5hdGlmIHBvdXIgbGUgd2lkZ2V0IHBlcnNvbm5hbGlzw6lcblx0Ly8gRGFucyBub3RyZSBleGVtcGxlLCBsZSB3aWRnZXQgbmF0aWYgZXN0IHVuIHBhcmVudCBkdSB3aWRnZXQgcGVyc29ubmFsaXPDqVxuXG5cdHZhciBuYXRpdmVXaWRnZXQgPSBzZWxlY3QucHJldmlvdXNFbGVtZW50U2libGluZztcblx0cmV0dXJuIG5hdGl2ZVdpZGdldC5zZWxlY3RlZEluZGV4O1xufVxuXG4vLyBOb3VzIGxpb25zIGxlIHdpZGdldCBhdXggw6l2w6luZW1lbnRzIGTDqHMgbGUgY2hhcmdlbWVudCBkdSBkb2N1bWVudFxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGVjdExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNlbGVjdFwiKTtcblx0Ly8gQ2hhcXVlIHdpZGdldCBwZXJzb25uYWxpc8OpIGRvaXQgw6p0cmUgaW5pdGlhbGlzw6lcblx0c2VsZWN0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3QpIHtcblx0XHR2YXIgb3B0aW9uTGlzdCA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKFwiLm9wdGlvblwiKSxcblx0XHRcdHNlbGVjdGVkSW5kZXggPSBnZXRJbmRleChzZWxlY3QpO1xuXHRcdC8vIE5vdXMgcmVuZG9ucyBsZSB3aWRnZXQgcGVyc29ubmFsaXPDqSBjYXBhYmxlIGQnYXZvaXIgbGUgZm9jdXNcblx0XHRzZWxlY3QudGFiSW5kZXggPSAwO1xuXHRcdC8vIE5vdXMgZmFpc29ucyBlbiBzb3J0ZSBxdWUgbGUgd2lkZ2V0IG5hdGlmIG5lIHB1aXNzZSBwbHVzIGF2b2lyIGxlIGZvY3VzXG5cdFx0c2VsZWN0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcudGFiSW5kZXggPSAtMTtcblx0XHQvLyBOb3VzIG5vdXMgYXNzdXJvbnMgcXVlIGxhIHZhbGV1ciBzw6lsZWN0aW9ubsOpZSBwYXIgZMOpZmF1dCBlc3QgYmllbiBhZmZpY2jDqWVcblx0XHR1cGRhdGVWYWx1ZShzZWxlY3QsIHNlbGVjdGVkSW5kZXgpO1xuXHRcdC8vIENoYXF1ZSBmb2lzIHF1ZSBsJ3V0aWxpc2F0ZXVyIGNsaXF1ZSBzdXIgdW5lIG9wdGlvbiwgbm91cyBtZXR0b25zIMOgXG5cdFx0Ly8gam91ciBsYSB2YWxldXIgZW4gYWNjb3JkXG5cdFx0b3B0aW9uTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChvcHRpb24sIGluZGV4KSB7XG5cdFx0XHRvcHRpb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0dXBkYXRlVmFsdWUoc2VsZWN0LCBpbmRleCk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0XHQvLyBDaGFxdWUgZm9pcyBxdWUgbCd1dGlsaXNhdGV1ciB1dGlsaXNlIGxlIGNsYXZpZXIgc3VyIHVuIHdpZGdldFxuXHRcdC8vIGF2ZWMgZm9jdXMsIGxlcyB2YWxldXJzIHNvbnQgbWlzZXMgw6Agam91ciBlbiBhY2NvcmRcblx0XHRzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgbGVuZ3RoID0gb3B0aW9uTGlzdC5sZW5ndGgsXG5cdFx0XHRcdGluZGV4ID0gZ2V0SW5kZXgoc2VsZWN0KTtcblx0XHRcdC8vIFF1YW5kIGwndXRpbGlzYXRldXIgcHJlc3NlIOKHkywgbm91cyBhbGxvbnMgw6AgbCdvcHRpb24gc3VpdmFudGVcblx0XHRcdGlmIChlLmtleUNvZGUgPT09IDQwICYmIGluZGV4IDwgbGVuZ3RoIC0gMSkge1xuXHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0fVxuXHRcdFx0Ly8gUXVhbmQgbCd1dGlsaXNhdGV1ciBwcmVzc2Ug4oeRLCBub3VzIHNhdXRvbnMgw6AgbCdvcHRpb24gc3VpdmFudGVcblx0XHRcdGlmIChlLmtleUNvZGUgPT09IDM4ICYmIGluZGV4ID4gMCkge1xuXHRcdFx0XHRpbmRleC0tO1xuXHRcdFx0fVxuXHRcdFx0Ly8gUXVhbmQgbCd1dGlsaXNhdGV1ciBwcmVzc2UgZW50ZXIsIG5vdXMgbWV0dG9ucyDDoCBqb3VyIGxhIHZhbGV1ciBlbiBhY2NvcmRcblx0XHRcdGlmIChlLmtleUNvZGUgPT09IDEzKSB7XG5cdFx0XHRcdHZhciBvcHRMaXN0ID0gc2VsZWN0LnF1ZXJ5U2VsZWN0b3IoXCIub3B0TGlzdFwiKTtcblx0XHRcdFx0Ly8gTm91cyBjaGFuZ2VvbnMgbGEgY2xhc3NlIGRlIGxhIGxpc3RlIHBvdXIgbCdlbnJvdWxlci9kw6lyb3VsZXJcblx0XHRcdFx0b3B0TGlzdC5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpO1xuXHRcdFx0XHRzZWxlY3QuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZVwiKTtcblx0XHRcdH1cblx0XHRcdHVwZGF0ZVZhbHVlKHNlbGVjdCwgaW5kZXgpO1xuXHRcdH0pO1xuXHR9KTtcbn0pO1xuIl19
